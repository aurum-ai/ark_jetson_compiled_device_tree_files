// SPDX-License-Identifier: GPL-2.0-only
// Copyright (c) 2024 ARK Electronics

#include "tegra234-camera-tc358743.dtsi"

#define CAMERA_I2C_MUX_BUS(x) (0x1E + x)

/ {
    fragment-camera@0 {
        target-path = "/";
        __overlay__ {
            i2c@3180000 {
                status = "okay";
                clock-frequency = <400000>;

                tca9548@70 {
                    compatible = "nxp,pca9548";
                    reg = <0x70>;
                    reset-gpios = <&gpio TEGRA234_MAIN_GPIO(H, 7) GPIO_ACTIVE_LOW>;
                    vcc-supply = <&vdd_3v3_sys>;
                    skip_mux_detect = "yes";
                    force_bus_start = <0x1E>;

                    i2c@0 {
                        reg = <0>;
                        i2c-mux,deselect-on-exit;
                        #address-cells = <1>;
                        #size-cells = <0>;

                        imx219_a@10 {
                            status = "disabled";
                        };

                        tc358743: tc358743@0f {
                            status = "okay";
                        };
                    };

                    i2c@1 {
                        reg = <1>;
                        imx219_b@10 {
                            status = "disabled";
                        };
                    };

                    i2c@2 {
                        reg = <2>;
                        imx219_c@10 {
                            status = "disabled";
                        };
                    };

                    i2c@3 {
                        reg = <3>;
                        imx219_d@10 {
                            status = "disabled";
                        };
                    };
                };
            };
        };
    };
};
